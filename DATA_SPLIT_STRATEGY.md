# 数据分割策略分析报告

## 📊 核心结论

**两个数据集都采用冷启动分割 (Cold-Start Split) 策略**

这意味着：
- ✅ Train/Valid和Test中的学生**完全不同**，没有任何重叠
- ✅ 模型评估的是对**全新学生**的泛化能力
- ✅ 这是真实应用场景：新用户注册后立即使用模型

## 🔍 详细统计

### EdNet 数据集

| 指标 | 数值 | 比例 |
|-----|------|------|
| Train/Valid学生数 | 3,750 | 80.0% |
| Test学生数 | 937 | 20.0% |
| 重叠学生数 | 0 | 0% |
| 总学生数 | 4,687 | 100% |

**Fold分布** (5-Fold交叉验证):
- 每个Fold: 750个学生
- Fold之间无重叠

### ASSISTments2017 数据集

| 指标 | 数值 | 比例 |
|-----|------|------|
| Train/Valid学生数 | 1,367 | 80.0% |
| Test学生数 | 341 | 20.0% |
| 重叠学生数 | 0 | 0% |
| 总学生数 | 1,708 | 100% |

**Fold分布** (5-Fold交叉验证):
- Fold 0-1: 274个学生/每个
- Fold 2-4: 273个学生/每个
- Fold之间无重叠

## 📋 数据分割类型对比

### 🆕 冷启动分割 (Cold-Start Split) - **当前使用**

**特点：**
- Train/Valid和Test使用**完全不同的学生**
- 无学生重叠

**评估目标：**
- 模型对**新学生**的泛化能力
- 适用于新用户冷启动场景

**应用场景：**
- 新用户注册后立即推荐
- 无需历史数据即可预测

**优点：**
- 更符合真实应用场景
- 评估模型的泛化能力

**挑战：**
- 难度较高（无历史信息）
- 需要模型学习通用模式

---

### ⏱️ 时序分割 (Temporal Split) - **未使用**

**特点：**
- 同一学生的**早期数据**在Train中
- 同一学生的**后期数据**在Test中
- 有学生重叠

**评估目标：**
- 模型对**已知学生未来表现**的预测能力

**应用场景：**
- 已有历史数据的老用户
- 个性化推荐

**优点：**
- 可以利用学生历史信息
- 评估难度相对较低

## 💡 对模型设计的启示

### 1. Student ID不是输入
由于采用冷启动分割：
- 模型在测试时遇到的都是**训练时从未见过的学生**
- 即使`student_id`是输入，测试集的ID也从未在训练集出现
- 因此`student_id`作为输入**没有意义**
- 模型必须学习**通用的答题模式**，而不是记住特定学生

### 2. 模型学习目标
模型需要学习的是：
- ✅ 题目之间的知识关联
- ✅ 答题序列的通用模式
- ✅ 知识点的遗忘曲线
- ❌ 特定学生的个人特征

### 3. Forgetting Score计算
对于冷启动场景：
- 不能依赖学生的长期历史
- 只能基于当前答题序列计算
- 更依赖时间间隔和概念关联

### 4. 评估指标的含义
当前的AUC/ACC指标反映：
- 模型对**新学生**的预测准确度
- **无需任何历史数据**的预测能力
- 真实的冷启动性能

## 🎯 Validation策略

### 5-Fold交叉验证

**工作原理：**
1. 将3,750个学生（EdNet）或1,367个学生（ASSISTments2017）分成5个Fold
2. 每个Fold包含不同的学生（无重叠）
3. 轮流使用：
   - 1个Fold作为验证集
   - 4个Fold作为训练集
4. 得到5次训练结果，选择最佳checkpoint

**好处：**
- 充分利用训练数据
- 评估模型稳定性
- 减少随机性影响

## 📊 数据完整性验证

✅ **所有检查通过：**
- Train/Valid的5个Fold之间无学生重叠
- Train/Valid和Test之间无学生重叠
- 数据分割清晰、无泄露风险
- 符合标准的机器学习实践

## 🔬 实验建议

基于这种数据分割策略：

### 1. 模型比较是公平的
- 所有模型面对相同的冷启动挑战
- 评估结果可以直接比较

### 2. 特征工程建议
- 重点关注题目特征和序列模式
- 不要过度依赖学生ID相关特征
- 关注时间特征（间隔、遗忘）

### 3. Forgetting Score应用
- 计算时只使用当前序列信息
- 不假设有长期历史数据
- 参数τ的选择更加重要

### 4. 模型改进方向
- 提升对新学生的泛化能力
- 增强序列模式学习
- 改进冷启动预测准确度

## 📁 相关文件

- **分析脚本**: `/mnt/localssd/analyze_student_split.py`
- **分析结果**: `/tmp/student_split_analysis.txt`
- **对比CSV**: `/tmp/student_split_analysis.csv`

## 🔄 复现分析

```bash
cd /mnt/localssd
source activate pykt
python analyze_student_split.py
```

---

**生成时间**: 2025-10-19  
**分析工具**: analyze_student_split.py  
**数据集**: EdNet, ASSISTments2017

