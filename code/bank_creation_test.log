============================================================
  创建学生Persona和Memory Bank
============================================================

⚠️  测试模式：每个数据集处理3个学生


============================================================
处理数据集: assist2017
============================================================

总学生数: 3
加载BGE-M3模型...
Fetching 30 files:   0%|          | 0/30 [00:00<?, ?it/s]Fetching 30 files: 100%|██████████| 30/30 [00:00<00:00, 8182.94it/s]
BGE-M3加载完成
初始化LLM客户端...
LLM客户端就绪
assist2017:   0%|          | 0/3 [00:00<?, ?it/s]
pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 262.75it/s]
You're using a XLMRobertaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 66.04it/s]

pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 944.88it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 79.87it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 996.63it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][A
Inference Embeddings: 100%|██████████| 2/2 [00:00<00:00,  2.13it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00,  2.13it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 972.48it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 77.86it/s]
assist2017:  33%|███▎      | 1/3 [00:11<00:23, 11.88s/it]
pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 2290.72it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 77.70it/s]

pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 4573.94it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 81.24it/s]

pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 1888.48it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 70.31it/s]

pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 2029.17it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 74.70it/s]
assist2017:  67%|██████▋   | 2/3 [00:14<00:06,  6.20s/it]
pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 1036.91it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 60.19it/s]

pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 1307.86it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 80.25it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 1133.29it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][A
Inference Embeddings:  50%|█████     | 1/2 [00:00<00:00,  1.31it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00,  2.58it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 1002.46it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 78.84it/s]
assist2017: 100%|██████████| 3/3 [00:20<00:00,  6.18s/it]assist2017: 100%|██████████| 3/3 [00:20<00:00,  6.75s/it]

  ✅ 保存完成:
    Persona: 3 学生
    Memory: 3 学生
    Last interactions: 2 学生

✅ assist2017 完成: 成功3, 跳过0, 错误0

============================================================
处理数据集: nips_task34
============================================================

总学生数: 3
nips_task34:   0%|          | 0/3 [00:00<?, ?it/s]
pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 986.20it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 72.91it/s]

pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 1200.09it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 76.66it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 1046.61it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 70.95it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 1194.28it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 79.43it/s]
nips_task34:  33%|███▎      | 1/3 [00:03<00:07,  3.90s/it]
pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 1488.93it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 68.98it/s]

pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 1855.07it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 75.71it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 1032.44it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 72.03it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 881.99it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 79.76it/s]
nips_task34:  67%|██████▋   | 2/3 [00:07<00:03,  3.76s/it]
pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 307.12it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 67.89it/s]

pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 1294.14it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 78.07it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 1008.00it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 73.03it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 952.71it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 80.32it/s]
nips_task34: 100%|██████████| 3/3 [00:11<00:00,  3.94s/it]nips_task34: 100%|██████████| 3/3 [00:11<00:00,  3.91s/it]

  ✅ 保存完成:
    Persona: 3 学生
    Memory: 3 学生
    Last interactions: 2 学生

✅ nips_task34 完成: 成功3, 跳过0, 错误0

============================================================
处理数据集: algebra2005
============================================================

总学生数: 3
algebra2005:   0%|          | 0/3 [00:00<?, ?it/s]
pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 725.16it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 68.67it/s]

pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 929.59it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 82.45it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 860.37it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 71.49it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 914.19it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 78.12it/s]
algebra2005:  33%|███▎      | 1/3 [00:04<00:09,  4.57s/it]
pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 733.27it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 68.64it/s]

pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 957.82it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 78.99it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 1090.70it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 68.92it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 973.16it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 80.49it/s]
algebra2005:  67%|██████▋   | 2/3 [00:07<00:03,  3.89s/it]
pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 916.59it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 71.18it/s]

pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 1035.63it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 83.22it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 1104.93it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 69.43it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 1029.53it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 79.93it/s]
algebra2005: 100%|██████████| 3/3 [00:12<00:00,  4.00s/it]algebra2005: 100%|██████████| 3/3 [00:12<00:00,  4.04s/it]

  ✅ 保存完成:
    Persona: 3 学生
    Memory: 3 学生
    Last interactions: 1 学生

✅ algebra2005 完成: 成功3, 跳过0, 错误0

============================================================
处理数据集: bridge2006
============================================================

总学生数: 3
bridge2006:   0%|          | 0/3 [00:00<?, ?it/s]
pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 2104.52it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 70.34it/s]

pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 2560.63it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 81.45it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 1041.93it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 76.74it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 1083.94it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 80.27it/s]
bridge2006:  33%|███▎      | 1/3 [00:02<00:05,  2.88s/it]
pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 1602.71it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 62.60it/s]

pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 2078.45it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 75.54it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 1023.00it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 73.43it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 1227.84it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 79.84it/s]
bridge2006:  67%|██████▋   | 2/3 [00:06<00:03,  3.11s/it]
pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 784.86it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 66.76it/s]

pre tokenize:   0%|          | 0/1 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 1/1 [00:00<00:00, 1085.48it/s]

Inference Embeddings:   0%|          | 0/1 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 1/1 [00:00<00:00, 80.13it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 1239.63it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 74.60it/s]

pre tokenize:   0%|          | 0/2 [00:00<?, ?it/s][Apre tokenize: 100%|██████████| 2/2 [00:00<00:00, 1425.91it/s]

Inference Embeddings:   0%|          | 0/2 [00:00<?, ?it/s][AInference Embeddings: 100%|██████████| 2/2 [00:00<00:00, 78.61it/s]
bridge2006: 100%|██████████| 3/3 [00:11<00:00,  3.98s/it]bridge2006: 100%|██████████| 3/3 [00:11<00:00,  3.72s/it]

  ✅ 保存完成:
    Persona: 3 学生
    Memory: 3 学生
    Last interactions: 1 学生

✅ bridge2006 完成: 成功3, 跳过0, 错误0

============================================================
  ✅ 所有数据集处理完成！
============================================================
